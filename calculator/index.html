<!DOCTYPE html>
<html lang="ru">
  <head>
    <link rel="stylesheet" href="styles.css" />
    <link
      rel="stylesheet"
      href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"
    />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
  </head>
  <body>
    <div class="col-xs-12 flx">
      <div class="calc-block-left">
        <div class="calc">
          <div class="pad calc_block active">
            <div class="info_text qestion-line1">
              <span class="text">Сумма</span>
            </div>
            <div class="h2_deposit">
              <input id="deposit_val" type="text" value="5 000" />
            </div>
            <div class="com_sistem"></div>
            <div class="runner">
              <div
                id="autoCost"
                class="range_decor ui-slider ui-corner-all ui-slider-horizontal ui-widget ui-widget-content"
                min="5000"
                max="5000000"
                min-value-data="5000"
                value="5000"
                step="500"
              >
                <div
                  class="ui-slider-range ui-corner-all ui-widget-header ui-slider-range-min"
                  style="width: 0%"
                ></div>
                <span
                  tabindex="0"
                  class="ui-slider-handle ui-corner-all ui-state-default"
                  style="left: 0%"
                ></span>
              </div>
            </div>
            <!-- <div class="info_text qestion-line1">
            <span class="text">Первоначальный взнос</span>
            <span class="inf_icon">
            <span class="info_up firstPayment">Минимальная сумма первого взноса – <b>10%</b> от стоимости автомобиля</span>
            </span>
            </div>
            <div class="h2 deposit">
            <input id="firstPayment_val" type="text" value="300 000 руб.">
            <div class="err_firstPayment_val"></div>
            </div>
            <div class="com_sistem"></div>
            <div class="runner">
            <div id="firstPayment" class="range_decor ui-slider ui-corner-all ui-slider-horizontal ui-widget ui-widget-content" min="60000" max="1000000" min-value-data="100000" value="300000" step="500"><div class="ui-slider-range ui-corner-all ui-widget-header ui-slider-range-min" style="width: 0%;"></div><span tabindex="0" class="ui-slider-handle ui-corner-all ui-state-default" style="left: 0%;"></span></div>
            </div> -->
            <div class="err_deposit_val">от 5 000 руб.</div>
            <div class="info_text qestion-line1">
              <span class="text">Срок вклада</span>
            </div>

            <div class="select-wrapper-popup">
              <div class="popup-list">
                <select name="select-popup-list" id="term" class="select-popup">
                  <option value="3">3 месяца</option>
                  <option value="6">6 месяцев</option>
                  <option value="12">12 месяцев</option>
                </select>
              </div>
            </div>

            <div class="com_sistem"></div>

            <p class="info-h">
              Информация носит справочный характер, не является офертой.
            </p>
          </div>
        </div>
      </div>
      <div class="calc-block-right">
        <p class="p_ff_pts mt-0">Накопите через <span id="months">n</span></p>
        <p class="p_ff_dt">
          <span id="finalAmount"></span><span class="rouble"></span>
        </p>
        <div class="info_text mt-15">
          <span class="text deposit_result"
            >При ставке <span>17%</span> годовых</span
          >
        </div>
        <p class="p_ff_pts">Доход</p>
        <p class="p_ff_dt">
          <span id="income"></span><span class="rouble"></span>
        </p>
        <!-- <div class="h1 deposit_result"><span>13 </span> %</div> -->

        <!-- <p class="p_ff_pts">Сумма ежемесячного платежа:</p>
        <p class="p_ff_dt"><span id="payments">300 000</span><span class="rouble">&#8399;</span></p> -->
        <a href="#" class="btn blue popup esia-popup-link mt-30"
          >Отправить заявку</a
        >
      </div>
    </div>
    <script>
      // ЭТО КОД КАЛЬКУЛЯТОРА
      function calculate() {
        var amount = parseInt($("#deposit_val").val().replace(/\s/g, ""), 10);
        var term = parseInt($("#term").val(), 10);
        var rate = 0.17;
        var daysInYear = new Date().getFullYear() % 4 === 0 ? 366 : 365;
        var daysInTerm;

        // Определение количества дней в зависимости от срока
        if (term === 3) {
          daysInTerm = 91; // 3 месяца
        } else if (term === 6) {
          daysInTerm = 91 * 2; // 6 месяцев
        } else if (term === 12) {
          daysInTerm = 91 * 4; // 12 месяцев
        }

        var income = ((amount * rate) / daysInYear) * daysInTerm;

        var termText = term === 3 ? "месяца" : "месяцев";
        $("#months").text(term + " " + termText);
        $("#finalAmount").text((amount + income).toFixed(0));
        $("#income").text(income.toFixed(0));
      }
    </script>
    <script>
      // ЭТО КОД ПОЛЗУНКА
      $(function () {
        $("#autoCost").slider({
          range: "min",
          value: 0,
          min: 5000,
          max: 5000000,
          step: 500,
          slide: function (event, ui) {
            $("#deposit_val").val(ui.value); // Обновление поля ввода при изменении ползунка
            calculate();
          },
        });

        $("#deposit_val").change(function () {
          var value = $(this).val().replace(/\D/g, ""); // Удаление нечисловых символов
          value = parseInt(value, 10); // Преобразование строки в число
          if (value >= 5000 && value <= 5000000) {
            $("#autoCost").slider("value", value); // Обновление ползунка при изменении поля ввода
            calculate();
          }
        });

        $("#term").change(calculate);
        calculate();
      });
    </script>
  </body>
</html>
